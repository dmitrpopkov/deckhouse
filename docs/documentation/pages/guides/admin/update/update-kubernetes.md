---
title: Изменение версии Kubernetes в Deckhouse Kubernetes Platform
permalink: ru/update/update-kubernetes/
lang: ru
---

{% alert level="info" %}
Модули `node-manager` и `control-plane-manager` обеспечивают механизмы обновления Kubernetes. Убедитесь, что они включены.
{% endalert %}

Deckhouse Kubernetes Platform (DKP) меняет версию Kubernetes на узлах в кластере автоматически после [настройки параметра `kubernetesVersion`](#как-изменить-версию-kubernetes-на-узлах). Обновление выполняется безопасно и для single-master, и для multi-master-кластеров. На работу приложений в кластере обновление не влияет и может выполняться без выделения окна для регламентных работ.

В параметре `kubernetesVersion` ресурса *ClusterConfiguration* можно задать:
* значение `Automatic`, тогда DKP будет обновлять версию Kubernetes на узлах в соответствии с версией Kubernetes в релизе DKP. Посмотреть версии можно на странице [Поддерживаемые версии Kubernetes и ОС](https://deckhouse.io/documentation/v1/supported_versions.html).
* желаемую версию, например `1.27`, тогда DKP будет приводить версии узлов в кластере к указанной версии. Если версия устареет, то ее снова нужно будет поменять в параметре.

DKP запускает изменение версий групп узлов одновременно. Узлы внутри каждой группы обновляются последовательно:  
- **при переходе к новой версии** обновление происходит по одной минорной версии, например от 1.26 к 1.27, от 1.27 к 1.28, от 1.28 к 1.29. На каждом этапе сначала обновляется версия управляющего слоя (control plane), затем `kubelet` на узлах кластера.
- **при переходе к старой версии** успех гарантируется только на одну версию вниз от максимальной минорной версии управляющего слоя, когда-либо использовавшейся в кластере:
  - происходит понижение версии `kubelet` на узлах кластера.
  - происходит понижение версии компонентов управляющего слоя.

Текущая версия Kubernetes в кластере определяется по версиям управляющего слоя и узлов кластера.

## Как изменить версию Kubernetes на узлах?

1. Выполните:

   ```
   kubectl -n d8-system exec -ti deploy/deckhouse --deckhouse-controller edit cluster-configuration
   ```

1. Измените параметр `kubernetesVersion`, выбрав `kubernetesVersion: Automatic` или указав желаемую версию.
1. Сохраните изменения.
    
    DKP начнет проверять и при необходимости менять версии узлов и компонентов в кластере. Отслеживайте ход обновления с помощью команды `kubectl get no`. Когда в выводе команды у каждого узла кластера в колонке `VERSION` появится нужная версия, обновление можно считать завершенным.
